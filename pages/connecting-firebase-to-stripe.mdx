# Configuring the "Run Payments with Stripe" Extension

Once you've created a Stripe webhook, you'll need to configure the "Run Payments with Stripe" extension to handle various Stripe events, such as payment successes, subscription updates, and cancellations. Follow the steps below to ensure everything is set up correctly.

## Prerequisites

- A Firebase project with the "Run Payments with Stripe" extension installed.

    - Visit [Run Payments With Stripe](https://extensions.dev/extensions/stripe/firestore-stripe-payments)
    - Install the "Run Payments with Stripe" extension to the Firebase project created earler.

- A Stripe account with a webhook created and configured to send events to your Firebase project.

## Step 1: Verify Your Webhook URL

Make sure your Stripe webhook is pointing to the correct URL. Typically, this will be your Firebase Cloud Function endpoint that was automatically set up by the extension. You can find this URL in the Firebase Console under **Functions**.

1. Navigate to your Stripe Dashboard.
2. Go to **Developers > Webhooks**.
3. Ensure the webhook URL matches your Firebase Cloud Function endpoint.

## Step 3: Review the Extension Configuration

Check that the "Run Payments with Stripe" extension is correctly configured to handle the incoming events. The extension should already have settings in place for managing subscriptions, handling payments, and updating your Firebase database.

1. Go to your Firebase Console.
2. Navigate to **Extensions** and select the "Run Payments with Stripe" extension.
3. Review the configuration options. Ensure that the necessary Firestore paths, functions, and API keys are set up.

## Step 4: Test the Integration

Before going live, it's important to test the webhook to ensure everything is working correctly.

1. In your Stripe Dashboard, go to **Developers > Webhooks**.
2. Select your webhook and click **Send test webhook**.
3. Choose an event type (e.g., `checkout.session.completed`) and click **Send test webhook**.
4. Verify that the test event triggers the correct updates in your Firebase database.

## Step 5: Monitor and Troubleshoot

After deploying, keep an eye on both the Stripe Dashboard and Firebase Console to monitor for any issues.

- **Stripe Dashboard:** Check the logs under **Developers > Webhooks** to ensure events are being delivered successfully.
- **Firebase Console:** Monitor your Cloud Function logs to catch any errors or unexpected behavior.

## Conclusion

Your "Run Payments with Stripe" extension should now be fully configured and ready to handle Stripe events through your webhook. This setup allows you to automate payment processing and keep your Firebase database in sync with Stripe.

For more advanced configurations: 

- [Stripe documentation](https://stripe.com/docs/webhooks)

- [Firebase Extensions documentation](https://firebase.google.com/products/extensions).

